@model List<UserPayTestViewModel>

@{
    ViewBag.Title = "Lịch sử mua DASS21 Test";
    int currentPage = ViewBag.CurrentPage;
    int totalPages = ViewBag.TotalPages;
    Layout = "~/Views/Shared/_LayoutManager.cshtml";
}

<h2 class="text-center mt-4 mb-4">Lịch sử mua DASS21 Test</h2>

<div class="container">
    <form asp-action="DeleteMultiple" method="post">
        <div class="table-responsive">
            <table class="table table-bordered align-middle" style="min-width: 1000px;">
                <thead class="table-dark">
                    <tr>
                        <th><input type="checkbox" id="selectAll" hidden/></th>
                        <th>Họ tên</th>
                        <th>Email</th>
                        <th>SĐT</th>
                        <th>Địa chỉ</th>
                        <th>Giới tính</th>
                        <th>Ngày sinh</th>
                        <th>Ngày thanh toán</th>
                        <th>Tổng tiền</th>
                        
                    </tr>
                </thead>
                <tbody>
                    @foreach (var user in Model)
                    {
                        <tr>
                            <td>
                                <input type="checkbox" name="selectedIds" value="@user.UserId" />
                            </td>
                            <td>@user.Name</td>
                            <td>@user.Email</td>
                            <td>@user.Phone</td>
                            <td>@user.Address</td>
                            <td>@user.Gender</td>
                            <td>@user.DateOfBirth?.ToString("dd/MM/yyyy")</td>
                            <td>@user.DatePayTest?.ToString("dd/MM/yyyy")</td>
                            <td>@user.Price VND</td>
                            
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <button type="submit" class="btn btn-danger mt-2">Xóa đã chọn</button>
    </form>

    <!-- Phân trang -->
    <nav>
        <ul class="pagination justify-content-center" style="margin-top: 20px;">
            <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                <a class="page-link" asp-action="HisToryPayTest" asp-route-page="@(currentPage - 1)">Previous</a>
            </li>

            @for (int i = 1; i <= totalPages; i++)
            {
                <li class="page-item @(i == currentPage ? "active" : "")">
                    <a class="page-link" asp-action="HisToryPayTest" asp-route-page="@i">@i</a>
                </li>
            }

            <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                <a class="page-link" asp-action="HisToryPayTest" asp-route-page="@(currentPage + 1)">Next</a>
            </li>
        </ul>
    </nav>
</div>

@section Scripts {
    <script>
        // Tự động check/uncheck tất cả checkbox
        document.getElementById('selectAll').addEventListener('change', function () {
            var checkboxes = document.querySelectorAll('input[name="selectedIds"]');
            for (var checkbox of checkboxes) {
                checkbox.checked = this.checked;
            }
        });
    </script>
}
